#include <thread>
#include <unistd.h>
#include <iostream>
#include "adas_v2_protocol.h"
#include "adas_v2_type.h"

namespace adas {
namespace protocol_v2 {

class DerivedTestClass : public AdasV2Protocol {
public:
    void ehp_v2_callback(const std::string& ehp_v2_json) override {
        std::cout << ehp_v2_json << std::endl;
    }
};

std::string route = "{\"route\":{\"type\":2,\"session_id\":\"{\\\"codr\\\":\\\"BDE4512CD6BB26B9FFB6A6EF70276E69|0_31.259150,121.392620_31.17981,121.60559_87\\\",\\\"loc\\\":\\\"gz\\\"}@667\",\"mrsl\":\"\\\"g\\\":\\\"0_1\\\",\\\"w\\\":\\\"AAAA\\\",\\\"p\\\":\\\"1\\\",\\\"s\\\":\\\"1\\\",\\\"seq\\\":\\\"0\\\"\",\"route_id\":\"68678427397153\",\"steps\":[],\"actions\":[{\"in_link_index\":16,\"out_link_index\":17,\"turn_kind\":34,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":18,\"out_link_index\":19,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":21,\"out_link_index\":22,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":22,\"out_link_index\":23,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":31,\"out_link_index\":32,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":37,\"out_link_index\":40,\"turn_kind\":71,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":64,\"out_link_index\":65,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":88,\"out_link_index\":91,\"turn_kind\":5,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":92,\"out_link_index\":93,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":93,\"out_link_index\":94,\"turn_kind\":25,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":94,\"out_link_index\":95,\"turn_kind\":5,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":95,\"out_link_index\":96,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":117,\"out_link_index\":119,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":142,\"out_link_index\":144,\"turn_kind\":2,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":150,\"out_link_index\":153,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":242,\"out_link_index\":246,\"turn_kind\":50,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":256,\"out_link_index\":257,\"turn_kind\":22,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":262,\"out_link_index\":263,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":280,\"out_link_index\":281,\"turn_kind\":20,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":324,\"out_link_index\":325,\"turn_kind\":20,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":332,\"out_link_index\":334,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":334,\"out_link_index\":335,\"turn_kind\":26,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":335,\"out_link_index\":336,\"turn_kind\":5,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":336,\"out_link_index\":338,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":345,\"out_link_index\":346,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":349,\"out_link_index\":352,\"turn_kind\":18,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":371,\"out_link_index\":372,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":381,\"out_link_index\":382,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":386,\"out_link_index\":387,\"turn_kind\":22,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":398,\"out_link_index\":399,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":405,\"out_link_index\":406,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":416,\"out_link_index\":419,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":421,\"out_link_index\":422,\"turn_kind\":27,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":429,\"out_link_index\":430,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":448,\"out_link_index\":449,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":451,\"out_link_index\":454,\"turn_kind\":34,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":476,\"out_link_index\":477,\"turn_kind\":22,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":495,\"out_link_index\":497,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":508,\"out_link_index\":509,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":525,\"out_link_index\":526,\"turn_kind\":22,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":543,\"out_link_index\":544,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":547,\"out_link_index\":548,\"turn_kind\":28,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":561,\"out_link_index\":562,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":586,\"out_link_index\":588,\"turn_kind\":55,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":591,\"out_link_index\":594,\"turn_kind\":22,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":601,\"out_link_index\":602,\"turn_kind\":34,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":639,\"out_link_index\":640,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":643,\"out_link_index\":644,\"turn_kind\":34,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":687,\"out_link_index\":688,\"turn_kind\":19,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":693,\"out_link_index\":696,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":705,\"out_link_index\":706,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":709,\"out_link_index\":712,\"turn_kind\":7,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":712,\"out_link_index\":713,\"turn_kind\":3,\"incross_link_index\":[],\"incross_turn_kind\":[]},{\"in_link_index\":713,\"out_link_index\":713,\"turn_kind\":24,\"incross_link_index\":[],\"incross_turn_kind\":[]}],\"linkids\":[16294306630,16294306640,16147305830,15915944770,15238676380,15914749860,16301087020,16301087010,16301087000,16199649460,15238646060,15238626910,15914427030,15238612580,16145377360,16243643340,16243580310,15238594720,15914620220,15690625410,16338490890,16338412990,15238636300,16079476130,16079417150,16600788050,16600788060,16343997570,15238657970,15475131310,15487951920,15746404680,16125112340,16738441000,16738455440,16350402150,16922813010,16922812170,15239579200,15746391600,16778588400,16778614960,16178290570,16251887890,16251887570,16178290550,16374355020,16374384810,16098645540,15239456160,16361178720,16361159980,16701507360,16701507350,16115438270,16115470580,16109739040,15239036340,16388355640,16388362540,16176809710,16176809680,16176809750,16176809630,15238396750,15511655900,16785849870,16785849840,16785849730,16785849880,16785849830,16025282920,15977584250,16826739670,16826751880,16826751850,16826751690,16826751720,16826751920,16826751750,16826739710,16826751770,16826740120,16826751840,16826751860,16826740110,16826739660,16826751930,16826745390,16826746010,16826750920,16826739680,16826751890,15879891571,15879891571,15879891570,16826739690,16826740100,16826751790,16826751710,16826740130,16826751900,16826739700,16826751780,16826751810,16826751830,16826751820,16826751740,16826751730,16826745400,15977584251,16025282921,16785849831,16785849881,16785849731,16785849841,16785849871,15511655901,15238739871,16304307570,16637151020,16637161260,16637161250,16637142430,15239640610,16115423170,16115470020,15746423610,16137268650,15495277100,15475153400,15239527770,16361187570,16361187560,16281680290,16281667020,16281667030,16344368220,16344369390,16763488370,16815649500,16815655660,16815649880,16906680040,16906681140,16745295380,16178290560,16202961330,16202958520,16350402160,16350402260,15746378050,15746403890,15746404500,15690278220,16600788040,16600788020,16600788030,15976713050,15238666660,15624746220,15624751540,15238683670,15238500100,15690630090,16116814630,16116693860,16848040260,16848041460,16848039660,16338105490,16338105500,16850847420,16850845240,16711973250,16711972830,15238676410,15238567130,15452887900,15471493490,15980511850,15980496210,15238681950,15238663810,16915105630,16915105910,16742522440,16742522450,16336819310,16336819300,15603556720,15530532170,16153505640,16153505480,16153539740,15849346950,16877597040,15917932790,15535139510,15745046430,15999743100,15999733910,15763414290,15745025720,16243612920,16487084990,15238686020,16352829510,16352829500,16962447230,16962447180,16358648760,16358648750,16339645670,16339645660,16339554260,16287484190,16287484200,15238497490,15699903150,15699907100,15471330920,15541139950,15541140420,15605771680,15603116260,15919215560,16198991830,16198991940,16946965880,16946965870,16946965680,16948978000,16948979150,16352829480,16352829470,16352829490,15604819330,15238586510,15616911460,16856585680,16856585690,15497141040,15602529430,15238661510,15238641920,15238551060,15699905150,16004608730,16004605560,15238643780,15238585660,15699918430,15699913000,15699907250,15238664650,15238628720,15690626320,15690626860,16253884440,16253889500,15690632930,15914617890,15690637540,16211191220,16211188960,16211150100,15336732650,16733801690,16733800160,16941950540,16941950550,16014990900,16242185520,16242123380,15238656900,15751458240,16014991140,15765279950,16198018570,16957598290,15764133730,15238691880,15238519380,15745037180,16469688690,15238538350,15238555610,15238581960,15605892200,16344058710,16344058720,15605897460,15605899550,16233227110,16233227180,15238691170,16283548010,16283547930,15763422760,16146907550,16146895590,15238584970,15238568410,16222726340,16222727270,15600334860,16088184290,16088224290,15498957320,16076551490,16076551620,16195923440,16195923260,15510039290,15238612100,16022056050,16022078730,16022077240,16594845800,16594845810,15629130060,16022077870,16022079610,16022079570,15238616630,15238672660,16490035620,16490035650,15238593530,15745018110,15745007220,15744976950,15238671621,15501865351,15501865351,15501865350,15238671620,15629161310,15629118210,15624747820,15238568160,15238700300,15238569540,15699904210,15699914860,16116692830,16222743370,16222733050,16231281710,16231283450,16231283470,16231273130,15745037000,15238540410,16210009490,16210009670,15624744620,16131351610,16131345940,16478748480,16116688080,15238706960,16116693190,16116694300,15238542580,16000455190,16000526020,16076551670,16076551520,15238534650,15238665310,15690630980,15690638390,15238609120,16371304450,16371304440,15690637370,15238620830,15914875200,15914618950,15238674640,16221099890,16241514250,16241500020,16143287630,15629119080,15542023990,16204546540,16204541930,15497023050,15606133130,15238556980,16563429820,16563429810,16202950310,16202962450,16836244010,16836230230,16754328820,15237471850,16310503650,16310532370,16320637460,16320620660,15237754730,15628431350,15628431470,15982805660,15982801250,15743780980,15237833300,15239362750,15239388710,15237755370,16297872050,16297854330,15237960350,15238095740,16184415470,16965520350,16965520360,16965520360,16462199890,16462199920,16253885370,16287485280,16287485290,16279111670,16279096380,16171881750,16744585280,16744585270,16306378920,16306341580,15237463570,16462458040,16462458070,16301129080,16292046820,16751530230,16751530270,16751530220,16751530210,15982792100,15982805760,15982793400,16885476300,16885476310,15982804570,15982804460,15765281960,15238395170,16469964320,16469964310,15624816100,15624807390,16212301180,16212285570,15239472410,15238683580,16212299790,16212285370,16000525780,16105395880,16105400170,16000526380,16000448540,16705690890,16705690870,15624755450,15624751030,15624746120,15699919640,15699913550,15915632370,15557950190,15690633970,15690631480,15506351070,15544484730,15238560280,15918621000,15763431220,16711998090,16711997410,15616895870,15616898780,16000489460,16166799890,15616901130,15916953010,15238606700,16960913110,16961031640,16287488270,15238617470,16287481760,16287481750,15238703800,16243586740,16243617620,16143275040,16143278080,16193464270,16193464390,16193464310,15917217380,15238582350,15238562720,15570753860,16291008970,16291008980,16467262380,16467262390,16467262370,16485005890,16714089120,15919246250,15238502440,15806006690,15806065100,15238566530,15238547980,15238617890,15238573770,15751502080,15751489460,15238659480,16289322030,16379003640,16379003870,15469617720,15238573060,15606040210,15600547960,15238651690,16015361440,16015347690,16098641260,16015361450,16098892310,16076539330,15980503580,15980511050,16343842270,16343842280,15980511490,15980511490,16343842290,16343842300,16343842260,15538491430,16761395960,16761398890,16116815690,16116816180,15454960070,16352825730,16352825720,16140093080,16140104030,15601979660,16798211290,16798210760,16646839840,16646828670,16116765630,16116734450,15475114710,16116786810,16116790920,16593261880,16593261890,16360541780,16352788150,16352788140,16116738600,15530860540,15486179850,15478826930,15566360350,16672881100,16672870170,15570521600,15514342240,15590765760,15238537520,15624747410,16304819220,16234681480,15238687230,15238549890,15238607430,15531715350,15584796600,16098599420,16122590620,16122591330,15929760190,15929723060,16098579840,15690623610,15690633320,15452788760,15452788230,15452788220,15452788190,16379002080,16379001830,16310321200,16310321210,16346553120,16346530180,15914618040,15821723590,15238929190,16325663070,16325663360,16325663200,16325663640,16325663190,16325663160,16325663470,16325663150,16375798530,16375797590,16464721480,16464721490,16310335750,16310335740,16282862050,16282864980,16230706310,16230708920,16257439410,16257437070,16230714150,16230737810,16230709350,16230737870,16230737780,16474321560,16474307750,15495059650,15487711940,15238862670,16122991820,16123002180,15689520220,15238500160,15691369540,15691367970,15639757210,15691366710,15691368450,15721425770,15746469990,15746481730,15691369880,15691365480,15452710260,15919128360,15919126820,15691370460,15691370710,15691369470,15452710160,15691366980,15691371590,15691370930,15691367180,15691373010,15639756750,15639757000,15452710180,15691372810,16169181230,16169174350,15689657970,15689658960,15689665320,15721609210,15721609450,15452684040,15721609870,15721608890,15914602860,15689669450,16031859760,16240550980,16031076130,16600877990,16600878000,15238792060,15238714060,15689667580,15689656460,15237463040,16212180760,16212192900,15743812680,16367453500,16367453510,16306869600,16306865790,16285239820,16285239810,16255865050,15239361960,15743727210,15743779570,15717012660,16853031000],\"linklength\":[256,61,78,244,35,264,32,19,47,154,159,111,423,298,145,33,23,282,198,30,154,21,60,11,21,30,38,25,9,78,55,102,52,68,23,14,102,22,35,19,24,17,63,158,28,36,49,77,137,270,17,117,65,75,34,61,34,15,18,116,31,9,24,85,62,65,11,24,5,51,24,14,45,38,5,24,33,49,49,23,17,105,2,16,21,93,26,39,23,7,7,25,38,6,3,8,26,93,21,16,2,105,17,22,47,50,33,24,5,38,45,14,24,51,5,24,11,65,31,25,60,18,44,190,15,96,30,9,265,79,189,24,12,24,208,72,65,46,41,15,22,8,11,10,23,15,19,38,42,23,119,11,7,188,48,71,28,10,6,6,12,3,13,64,34,53,191,61,10,82,66,42,50,24,137,29,12,100,95,73,27,52,100,65,21,97,10,56,22,45,46,23,9,7,69,76,9,105,58,29,20,9,101,39,44,58,10,64,18,22,26,24,22,70,44,21,39,47,52,76,24,38,35,22,64,5,62,30,8,52,10,73,6,87,10,33,9,68,20,18,148,58,49,7,31,10,80,45,10,28,11,6,24,34,55,25,20,15,182,123,99,47,457,70,61,153,35,54,46,59,40,70,30,4,38,9,33,35,9,61,22,32,179,38,32,73,45,5,6,63,22,37,35,52,54,34,10,45,101,20,36,45,52,5,11,62,8,3,63,8,37,13,18,8,23,10,41,18,25,27,19,39,34,19,7,144,7,6,178,17,23,29,27,31,4,1,4,31,21,49,67,39,56,6,22,31,54,64,9,20,10,7,23,19,33,6,30,127,16,30,13,12,7,14,54,8,75,21,90,43,28,9,52,65,180,4,19,64,475,187,217,517,31,241,7,7,17,13,86,152,38,698,193,73,276,189,141,105,15,72,183,44,12,60,12,69,135,20,57,44,21,35,29,31,52,128,222,21,17,21,66,6,5,13,94,22,53,33,72,13,83,25,12,17,56,9,16,3,12,61,17,56,47,23,11,11,8,23,17,59,22,86,22,4,91,19,118,399,377,690,163,129,29,12,10,53,19,7,32,15,28,50,33,90,35,40,8,47,112,130,25,135,69,11,9,32,28,53,22,41,52,38,15,54,96,30,11,13,2,163,14,77,9,75,104,10,72,217,80,56,106,102,18,113,10,51,131,27,90,91,70,110,7,44,10,28,32,73,45,49,71,29,14,248,46,75,9,39,13,37,114,22,5,39,35,31,30,5,13,5,27,25,60,20,6,24,14,15,16,22,13,12,7,38,32,38,14,13,52,27,2,43,5,17,10,37,8,32,53,5,9,14,32,8,9,3,41,13,151,20,59,25,20,18,17,31,21,383,23,33,171,289,73,747,77,89,273,283,112,37,355,70,25,750,183,91,302,66,71,29,35,28,60,38,114,245,16,143,514,110,50,41,17,13,8,19,152,469,10,252,69,18,37,77,538,134,67,517,39,293,71,109,353,498,91,62,420,454,192,669,145,133,213,453,140,121,821,102,397,277,129,325,26,477,40,109,242,483,324,99,182,115,393,205,197,133,317,243,42,279,65,10,57,19,17,33,28,106,15,34,60,8,8,131,112,26,76,27,75,160,7,9,58,3],\"linkdirs\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1],\"netmode\":0,\"sd_version\":\"2551.0\"}}";

std::string position_str = "{\"position\":{\"dir\":206.0,\"elevated\":1,\"gps_loc\":[121.38612169053819,31.242491319444444],\"gps_loc_time\":1716960727998,\"link_dir\":206.64073181152344,\"link_id\":16294306630,\"link_offset\":160.60198974609375,\"offset\":160.60198974609375,\"path_id\":8,\"probability\":30.0,\"rectify_loc\":[0.0,0.0],\"rectify_loc_time\":1716960730297,\"speed\":21.475753784179688},\"route_id\":\"68678427397153\",\"version\":200}";

std::string path_str = "{\"link\":[{\"distance_to_pos\":-160.60198974609375,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":396.60198974609375,\"link_id\":16294306630,\"link_index\":0,\"offset\":0.0,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3868712,31.2437904],[121.3866268,31.2433784],[121.3863824,31.2429664],[121.3861072,31.2425012],[121.385832,31.242036],[121.3857474,31.2418931],[121.3854856,31.2414509],[121.385459,31.2414074],[121.3853192,31.241172],[121.3851056,31.2408296],[121.3849919,31.240611]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":236.0,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":61.05799865722656,\"link_id\":16294306640,\"link_index\":1,\"offset\":396.60198974609375,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3849919,31.240611],[121.3847456,31.2401888],[121.3847055,31.2401202]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":297.0580139160156,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":77.9000015258789,\"link_id\":16147305830,\"link_index\":2,\"offset\":457.6600036621094,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3847055,31.2401202],[121.3843392,31.2394944]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":374.9580078125,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":244.55599975585938,\"link_id\":15915944770,\"link_index\":3,\"offset\":535.5599975585938,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3843392,31.2394944],[121.3841472,31.2391568],[121.3840809,31.239035],[121.384031,31.238945],[121.383929,31.238748],[121.383768,31.238413],[121.3836683,31.238183],[121.3836306,31.238094],[121.383554,31.237906],[121.383452,31.237634],[121.3834266,31.2375626],[121.3833888,31.2374568]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":619.5140380859375,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":34.80500030517578,\"link_id\":15238676380,\"link_index\":4,\"offset\":780.1160278320313,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3833888,31.2374568],[121.3832796,31.2371584]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":654.3190307617188,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":264.8919982910156,\"link_id\":15914749860,\"link_index\":5,\"offset\":814.9210205078125,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3832796,31.2371584],[121.3831552,31.236784],[121.3830128,31.236384],[121.3829657,31.2362657],[121.382863,31.236014],[121.38274,31.235741],[121.38264,31.235538],[121.3825,31.235276],[121.3824164,31.2351352],[121.3823474,31.2350218],[121.3822954,31.2349389]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":919.2109985351563,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":32.43199920654297,\"link_id\":16301087020,\"link_index\":6,\"offset\":1079.81298828125,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3822954,31.2349389],[121.382222,31.234822],[121.3821284,31.234685]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":951.6430053710938,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,264,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":19.211000442504883,\"link_id\":16301087010,\"link_index\":7,\"offset\":1112.2449951171875,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3821284,31.234685],[121.38205,31.23457],[121.3820256,31.2345365]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":970.8540649414063,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":47.46900177001953,\"link_id\":16301087000,\"link_index\":8,\"offset\":1131.4560546875,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3820256,31.2345365],[121.38183,31.234267],[121.3817569,31.2341774]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":1018.3230590820313,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":154.24400329589844,\"link_id\":16199649460,\"link_index\":9,\"offset\":1178.925048828125,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3817569,31.2341774],[121.381697,31.234104],[121.381563,31.233946],[121.381201,31.233548],[121.3809325,31.2332712],[121.380752,31.2330912]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":1172.5670776367188,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268,289],\"lanenum\":4,\"lanenume2s\":0,\"length\":159.1060028076172,\"link_id\":15238646060,\"link_index\":10,\"offset\":1333.1690673828125,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.380752,31.2330912],[121.3805978,31.2329385],[121.3805828,31.2329237],[121.3803904,31.2327324],[121.3802168,31.2325544],[121.3801232,31.232456],[121.3800601,31.2323863],[121.380008,31.23233],[121.3798097,31.2320959],[121.3797325,31.2319952],[121.3797136,31.2319728]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":1331.6730346679688,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":111.64299774169922,\"link_id\":15238626910,\"link_index\":11,\"offset\":1492.2750244140625,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3797136,31.2319728],[121.3795082,31.2316768],[121.379458,31.2316],[121.379309,31.231341],[121.3791727,31.2310841]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":1443.3159790039063,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":4,\"lanenume2s\":0,\"length\":424.2560119628906,\"link_id\":15914427030,\"link_index\":12,\"offset\":1603.91796875,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3791727,31.2310841],[121.379042,31.230808],[121.378983,31.230674],[121.378746,31.230134],[121.3785116,31.2295939],[121.3782772,31.2290537],[121.3781984,31.228872],[121.3781136,31.2286592],[121.3780208,31.2284304],[121.377784,31.2278896],[121.3775924,31.2275216]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":1867.5719604492188,\"form_of_way\":2,\"is_complex_intersection\":false,\"is_part_of_route\":true,\"kind\":[258,268],\"lanenum\":5,\"lanenume2s\":0,\"length\":298.80999755859375,\"link_id\":15238612580,\"link_index\":13,\"offset\":2028.1739501953125,\"ownership\":0,\"path_id\":8,\"pathclass\":2,\"relative_probability\":30.0,\"road_grade\":1,\"shape\":[[121.3775924,31.2275216],[121.3774352,31.2271568],[121.3773008,31.2268432],[121.3770624,31.2262992],[121.376981,31.2260985],[121.376896,31.225886],[121.376799,31.225613],[121.376756,31.225471],[121.3767231,31.2253449],[121.3767177,31.2253244],[121.376708,31.225287],[121.3766813,31.2251639],[121.3766692,31.2251088],[121.376656,31.2250376],[121.3766441,31.2249687]],\"speed_limit\":80,\"speed_limit_type\":1,\"uflag\":1},{\"distance_to_pos\":654.3190307617188,\"form_of_way\":10,\"is_complex_intersection\":false,\"is_part_of_route\":false,\"kind\":[1029,1035],\"lanenum\":1,\"lanenume2s\":0,\"length\":42.731998443603516,\"link_id\":15238603360,\"link_index\":0,\"offset\":0.0,\"ownership\":0,\"path_id\":9,\"pathclass\":3,\"relative_probability\":0.0,\"road_grade\":4,\"shape\":[[121.3832796,31.2371584],[121.382953,31.236895]],\"speed_limit\":40,\"speed_limit_type\":1,\"uflag\":1}],\"max_send_length\":2000,\"path\":[{\"form_of_way\":2,\"id\":8,\"is_complex_intersection\":false,\"is_last_stub_at_offset\":false,\"is_part_of_route\":true,\"lanenume2s\":0,\"lanenums2e\":4,\"offset\":0.0,\"pathclass\":2,\"pid\":0,\"relative_probability\":30.0,\"right_of_way\":0,\"turn_angle\":0.0,\"type\":0},{\"form_of_way\":2,\"id\":6,\"is_complex_intersection\":false,\"is_last_stub_at_offset\":false,\"is_part_of_route\":true,\"lanenume2s\":0,\"lanenums2e\":4,\"offset\":0.0,\"pathclass\":2,\"pid\":8,\"relative_probability\":30.0,\"right_of_way\":0,\"turn_angle\":0.0,\"type\":2},{\"form_of_way\":2,\"id\":6,\"is_complex_intersection\":false,\"is_last_stub_at_offset\":false,\"is_part_of_route\":true,\"lanenume2s\":0,\"lanenums2e\":4,\"offset\":814.9210205078125,\"pathclass\":2,\"pid\":8,\"relative_probability\":30.0,\"right_of_way\":0,\"turn_angle\":-1.7203483535441535,\"type\":2},{\"form_of_way\":2,\"id\":6,\"is_complex_intersection\":false,\"is_last_stub_at_offset\":false,\"is_part_of_route\":true,\"lanenume2s\":0,\"lanenums2e\":5,\"offset\":2028.1739501953125,\"pathclass\":2,\"pid\":8,\"relative_probability\":30.0,\"right_of_way\":0,\"turn_angle\":-4.191609824600448,\"type\":2},{\"form_of_way\":10,\"id\":9,\"is_complex_intersection\":false,\"is_last_stub_at_offset\":false,\"is_part_of_route\":false,\"lanenume2s\":0,\"lanenums2e\":1,\"offset\":814.9210205078125,\"pathclass\":3,\"pid\":8,\"relative_probability\":0.0,\"right_of_way\":1,\"turn_angle\":31.013944567340218,\"type\":0}],\"route_id\":\"68678427397153\",\"version\":200}";


} // namespace protocol_v2
} // namespace adas

int main() {
    adas::protocol_v2::LocInfo loc;

    loc.speed = 21.475754;
    loc.link_id = 16294306630;
    loc.link_index = 0;
    loc.link_offset = 20.0;
    loc.direction = 206.7952;
    loc.link_direction = 206.64073;
    loc.timestamp = 1716960733671;
    loc.navi_route_id = "68678427397153";

    adas::protocol_v2::DerivedTestClass test_instance;

    test_instance.set_log_file("./ehp_out.log");

    test_instance.set_navi_route(adas::protocol_v2::route);

    test_instance.input_ehp_info(adas::protocol_v2::position_str);
    test_instance.input_ehp_info(adas::protocol_v2::path_str);

    usleep(1000 * 1000);

    test_instance.input_loc(loc);

    loc.speed = 21.46514;
    loc.link_id = 16294306630;
    loc.link_index = 0;
    loc.link_offset = 52.637527;
    loc.direction = 210.42578;
    loc.link_direction = 208.23584;
    loc.timestamp = 1716960729441;
    loc.navi_route_id = "68678427397153";

    usleep(1000 * 1000);

    test_instance.input_loc(loc);

    usleep(3000 * 1000);

    return 0;
}


